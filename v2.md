# API v2 propositions

## Input

List of ordonned `Feature`s (like v1) 

```json
[
  {
    "name": "feature1",
    "type": "string",
    "order": integer
  },
  {
    "name": "feature2",
    "type": "number",
    "order": integer
  },
]
```



## Ouput

Is a JSON object that only has simple types attributes (or array of simple types)

code 200

```json
    "output": {  
        "prediction": 129.89523842221215,
        "foo": "foo",
        "bar": true,
        "probabilities": [ 0.9, 0.4, 0.2 ],
    }
```

code 4XX

```json
    "error": {
        "errorCode": 1234,
        "errorMessage" : "Error"
    }
```

## [GET] `/models`

lists models

```json
    "model": {
        "id": "65454654-445-454--445-4",
        "name": "model name",
        "description": "",
        "trainedAt": "2020-07-15T14:52:02Z",
        "modifiedAt": "2020-07-15T14:52:02Z",

        "inputSchema": [],
        "outputSchema": {}
    }
```

## Deployments

* [GET] `/deployments` ?

  Retrieve all deployments

* [GET] `/models/{modelId}/deployments`?

  List deployments of a specified model

For ads-ml-service it means that modelId would use the `name` of the pickle metadata and deployement would be the `version` of the pickle metadata.

```json
    "deployment": {
        "id": "65454654-445-454--445-4",
        "name": "dep name",
        "status" : "ready",
        "deployedAt" : "2020-07-15T14:52:02Z"
        "modelId": "65454654-445-454--445-4" // ?
    }
```

## Optional

### [GET] `/models/{modelId}`

get model info

### [GET] `/models/{modelId}/deployments/{deploymentId}`

get info on a specified deployment of a specified model

### [GET] `/deployments/{deploymentId}/model`

get model from deploymentId

## Projections

|               | ads-ml-service  | SageMaker proxy                                              | WML        |
| ------------- | --------------- | ------------------------------------------------------------ | ---------- |
| Model         | Pickle metadata | Model                                                        | Model      |
| Deployment    | None            | Endpoint ( `estimator -> predictor`), can have multiple models | Deployment |
| Input Schema  | Pickle metadata | None                                                         |            |
| Output Schema | Pickle metadata | None                                                         |            |
| Training      |                 | `model -> estimator`                                         | Training   |
|               |                 |                                                              |            |

### SageMaker vocabulary 

1. Algorithm
2. Training Job
3. Model
4. EndpointConfig
5. Endpoint 

### Model

A _Model_ is a instance of a choosen algorithm and trained.

### Deployment 

Represents a deployed endpoint



## Wanted abstraction

* Training Job
  * Model 1
  * Model 2

* Project Name
  * Model 1
    * Endpoint 1
    * Endpoint 2
  * Model 2
    * Endpoint 3

* Model Name

  * Version 1

    * Endpoint 1
    * Endpoint 2

  * Version 2

    * Endpoint 3

    